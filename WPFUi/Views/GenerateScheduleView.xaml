<UserControl x:Class="WPFUi.Views.GenerateScheduleView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:WPFUi.Controls"
             xmlns:xceed="http://schemas.xceed.com/wpf/xaml/toolkit"
             xmlns:components="clr-namespace:WPFUi.Components"
             xmlns:system="clr-namespace:System;assembly=mscorlib" 
             xmlns:converters="clr-namespace:WPFUi.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <converters:MultiBindingConverter x:Key="MultiBindingConverter" />
        
        <ObjectDataProvider x:Key="DayOfWeek" 
                            MethodName="GetValues"
                            ObjectType="{x:Type system:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="system:DayOfWeek" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <components:DoctorPicker DataContext="{Binding DoctorPicker}" />
        </Grid>

        <Grid Grid.Row="1" Background="WhiteSmoke">
            <StackPanel Orientation="Vertical">

                <StackPanel Orientation="Horizontal">
                    <DatePicker SelectedDate="{Binding StartDate, Mode=OneWayToSource}" />
                    <DatePicker SelectedDate="{Binding EndDate, Mode=OneWayToSource}" />

                </StackPanel>

                <!-- Time picker -->
                <StackPanel Orientation="Horizontal">
                    
                    <!-- TODO: Create own TimePicker -->
                    <xceed:TimePicker Value="{Binding Path=StartHour, Mode=OneWayToSource}" Width="100" />
                    <xceed:TimePicker Value="{Binding Path=EndHour, Mode=OneWayToSource}" Width="100" />
                    
                    
                    
                </StackPanel>
                <ComboBox ItemsSource="{Binding TimeIntervalsList}"
                          SelectedItem="{Binding MaxTimePerPatient}">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock  Text="{Binding StringFormat={}mm}" />
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <Border Style="{StaticResource MainDarkBorder}" HorizontalAlignment="Center">
                    <ItemsControl ItemsSource="{Binding  Source={StaticResource DayOfWeek}}">
                        
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Margin="10"
                                          Content="{Binding}"                                           
                                          Command="{Binding Path=DataContext.SelectDaysOfWeekCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}">
                                    <CheckBox.CommandParameter>
                                        <MultiBinding Converter="{StaticResource MultiBindingConverter}">
                                            <Binding Path="IsChecked" RelativeSource="{RelativeSource Self}" />
                                            <Binding Path="Content" RelativeSource="{RelativeSource Self}" />
                                        </MultiBinding>
                                    </CheckBox.CommandParameter>
                                    
                                </CheckBox>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </Border>

                <ComboBox ItemsSource="{Binding Specializations}"
                          SelectedItem="{Binding SelectedSpecialization}">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}" />
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
            </StackPanel>

            <Button Style="{StaticResource MenuBarButton}"
                    Command="{Binding GenerateScheduleCommand}"
                    Content="Generate"/>

        </Grid>
        
    </Grid>
</UserControl>
